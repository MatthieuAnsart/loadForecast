<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="© Copyright IBM Corporation 2015" />
<meta name="DC.Rights.Owner" content="© Copyright IBM Corporation 2015" />
<meta name="security" content="public" />
<meta name="Robots" content="index,follow" />
<meta name="DC.Type" content="topic" />
<meta name="DC.Title" content="Writing to a spreadsheet" />
<meta name="abstract" content="Explains how to write to a spreadsheet from within OPL." />
<meta name="Description" content="Explains how to write to a spreadsheet from within OPL." />
<meta name="DC.subject" content="spreadsheets, writing to, R1C1 style not supported in Excel, Excel, R1C1 style not supported" />
<meta name="keywords" content="spreadsheets, writing to, R1C1 style not supported in Excel, Excel, R1C1 style not supported" />
<meta name="DC.Relation" scheme="URI" content="../../../OPL_Studio/opllangref/topics/opl_langref_spreadsheet.html" />
<meta name="DC.Date" scheme="iso8601" content="2015-05-15" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="usropllangref.uss_langref_datasources.1056138" />
<meta name="DC.Language" content="en-us" />
<meta name="IBM.Country" content="ZZ" />
<!-- Licensed Materials - Property of IBM -->
<!-- US Government Users Restricted Rights -->
<!-- Use, duplication or disclosure restricted by -->
<!-- GSA ADP Schedule Contract with IBM Corp. -->
<link rel="stylesheet" type="text/css" href="../../.././ibmdita.css" />
<link rel="stylesheet" type="text/css" href="../../.././swg_info_common_opti.css" />
<link rel="Start" href="../../../OPL_Studio/opllangref/topics/opl_langref_spreadsheet.html" />
<title>Writing to a spreadsheet</title>
</head>
<body role="main" id="usropllangref.uss_langref_datasources.1056138">
<h1 class="title topictitle1">Writing to a spreadsheet</h1>
<div class="body"><p class="shortdesc">Explains how to write to a spreadsheet from within OPL.</p>
<p class="p">This section uses extracts from the <span class="ph filepath">oilSheet.dat</span> data
file.</p>
<p class="p">Publishing results to a spreadsheet can be performed using instructions
such as:</p>
<pre class="pre codeblock"><code>a to SheetWrite(sheet,"RESULT!A2:A4");
blend to SheetWrite(sheet,"RESULT!B2:D4");</code></pre>
<p class="p">OPL then opens spreadsheets in read-write mode. This action may
fail if another process is already using the <span class="ph filepath">.xls</span> file.</p>
<p class="p">The types of data elements supported for writing are just the same
as for reading. Cells in Microsoft Excel spreadsheets are filled from
left to right and from top to bottom.</p>
<p class="p">Excel names (or named ranges) can be accessed using the <samp class="ph codeph">SheetWrite</samp> command,
using the following syntax: </p>
<pre class="pre codeblock"><code>SheetConnection sheetData("C:\\ILOG_Files\\myExcelFile.xls");
prods to SheetWrite(sheetData,"Product"); </code></pre>
<p class="p">Note the double separator \\ in the <samp class="ph codeph">SheetConnection</samp> command.
The <samp class="ph codeph">SheetWrite</samp> command is normal, and, in this example,
the Excel name <samp class="ph codeph">Product</samp> replaces the normal syntax
of, say, <samp class="ph codeph">C13:O72</samp>.</p>
<div class="note note"><span class="notetitle">Note:</span> <ul class="ul"><li class="li"><p class="p">OPL does not support the R1C1 reference style to specify the
range when writing data to an Excel spreadsheet.</p>
</li>
</ul>
 </div>
<p class="p">For more information on named ranges, see <a class="xref" href="opl_langref_datasources_spreadsheet_read.html#usropllangref.uss_langref_datasources.1056122__section1238607125434">Accessing named ranges in Excel</a>.</p>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../../../OPL_Studio/opllangref/topics/opl_langref_spreadsheet.html" title="Describes how to connect an MS Excel spreadsheet, read from it, and write the results to the connected spreadsheet.">Spreadsheet Input/Output</a></div>
</div>
</div></body>
</html>