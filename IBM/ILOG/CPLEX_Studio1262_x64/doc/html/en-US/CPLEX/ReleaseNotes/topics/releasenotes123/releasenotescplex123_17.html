<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="© Copyright IBM Corporation 2015" />
<meta name="DC.Rights.Owner" content="© Copyright IBM Corporation 2015" />
<meta name="security" content="public" />
<meta name="Robots" content="index,follow" />
<meta name="DC.Type" content="topic" />
<meta name="DC.Title" content="New features in callbacks" />
<meta name="abstract" content="New symbols in all APIs provide access to more information; new routines and methods offer greater control from callbacks." />
<meta name="Description" content="New symbols in all APIs provide access to more information; new routines and methods offer greater control from callbacks." />
<meta name="DC.Relation" scheme="URI" content="../../../../CPLEX/ReleaseNotes/topics/releasenotes123/releasenotescplex123_15.html" />
<meta name="DC.Date" scheme="iso8601" content="2015-05-15" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="descriptiveTopic1301324953161" />
<meta name="DC.Language" content="en-us" />
<meta name="IBM.Country" content="ZZ" />
<!-- Licensed Materials - Property of IBM -->
<!-- US Government Users Restricted Rights -->
<!-- Use, duplication or disclosure restricted by -->
<!-- GSA ADP Schedule Contract with IBM Corp. -->
<link rel="stylesheet" type="text/css" href="../../../.././ibmdita.css" />
<link rel="stylesheet" type="text/css" href="../../../.././swg_info_common_opti.css" />
<link rel="Start" href="../../../../CPLEX/ReleaseNotes/topics/releasenotes123/releasenotescplex123_15.html" />
<title>New features in callbacks</title>
</head>
<body role="main" id="descriptiveTopic1301324953161">
<h1 class="title topictitle1">New features in callbacks</h1>
<div class="body"><p class="shortdesc">New symbols in all APIs provide access to more information;
new routines and methods offer greater control from callbacks.</p>
<div class="section" id="descriptiveTopic1301324953161__section1300640842771"><h2 class="title sectiontitle">More information from callbacks</h2><p class="p">To support the new, more informative callbacks, and to
support very large models, where the number of nodes in the search
or the number of iterations can be correspondingly great, CPLEX V12.3
offers new symbols of type <samp class="ph codeph">long</samp>. These
symbols are available in all APIs of CPLEX. The table <a class="xref" href="releasenotescplex123_17.html#descriptiveTopic1301324953161__table1300643586283" title="A three-column table showing new values, their symbolic name, and their meaning.">Table 1</a> lists the new symbols available to
specify these new types of potentially <samp class="ph codeph">long</samp> information
in callbacks. </p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="A three-column table showing new values, their symbolic name, and their meaning." id="descriptiveTopic1301324953161__table1300643586283" class="table ShadedHead" rules="all" frame="border" border="1"><caption><span class="tablecap">Table 1. New values for informational callbacks</span></caption><thead class="thead" align="left"><tr class="row"><th class="entry" align="left" valign="top" width="33.33333333333333%" id="d265946e43">Value</th>
<th class="entry" align="left" valign="top" width="33.33333333333333%" id="d265946e45">Symbol</th>
<th class="entry" align="left" valign="top" width="33.33333333333333%" id="d265946e47">Meaning</th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e43 ">20</td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e45 "><samp class="ph codeph">CPX_CALLBACK_INFO_ITCOUNT_LONG</samp></td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e47 ">iteration count</td>
</tr>
<tr class="row"><td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e43 ">21</td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e45 "><samp class="ph codeph">CPX_CALLBACK_INFO_CROSSOVER_PPUSH_LONG</samp></td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e47 ">primal push crossover iteration count</td>
</tr>
<tr class="row"><td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e43 ">22</td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e45 "><samp class="ph codeph">CPX_CALLBACK_INFO_CROSSOVER_PEXCH_LONG</samp></td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e47 ">primal exchange crossover iteration count</td>
</tr>
<tr class="row"><td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e43 ">23</td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e45 "><samp class="ph codeph">CPX_CALLBACK_INFO_CROSSOVER_DPUSH_LONG</samp></td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e47 ">dual push crossover iteration count</td>
</tr>
<tr class="row"><td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e43 ">24</td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e45 "><samp class="ph codeph">CPX_CALLBACK_INFO_CROSSOVER_DEXCH_LONG</samp></td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e47 ">dual exchange crossover iteration count</td>
</tr>
<tr class="row"><td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e43 ">25</td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e45 "><samp class="ph codeph">CPX_CALLBACK_INFO_PRESOLVE_AGGSUBST_LONG</samp></td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e47 ">number of substitutions by aggregator</td>
</tr>
<tr class="row"><td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e43 ">26</td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e45 "><samp class="ph codeph">CPX_CALLBACK_INFO_PRESOLVE_COEFFS_LONG</samp></td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e47 ">number of coefficients modified by presolve</td>
</tr>
<tr class="row"><td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e43 ">140</td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e45 "><samp class="ph codeph">CPX_CALLBACK_INFO_NODE_COUNT_LONG</samp></td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e47 ">total number of nodes solved</td>
</tr>
<tr class="row"><td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e43 ">141</td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e45 "><samp class="ph codeph">CPX_CALLBACK_INFO_NODES_LEFT_LONG</samp></td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e47 ">number of remaining nodes</td>
</tr>
<tr class="row"><td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e43 ">142</td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e45 "><samp class="ph codeph">CPX_CALLBACK_INFO_MIP_ITERATIONS_LONG</samp></td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e47 ">total number of MIP iterations</td>
</tr>
<tr class="row"><td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e43 ">220</td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e45 "><samp class="ph codeph">CPX_CALLBACK_INFO_NODE_SEQNUM_LONG</samp></td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e47 ">sequence number of the node</td>
</tr>
<tr class="row"><td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e43 ">221</td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e45 "><samp class="ph codeph">CPX_CALLBACK_INFO_NODE_NODENUM_LONG</samp></td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e47 ">node index of the node</td>
</tr>
</tbody>
</table>
</div>
<p class="p"> </p>
<p class="p">Routines or methods to use and access this additional
information from callbacks are available in all APIs of CPLEX.</p>
<ul class="ul"><li class="li"><p class="p">For the <strong class="ph b">Callable Library
(C API)</strong>, see the reference manual for documentation
of routines that use these symbols, such routines as</p>

<p class="p"> <span class="keyword apiname">CPXgetcallbackinfo</span> or</p>

<p class="p"> <span class="keyword apiname">CPXgetcallbackseqinfo</span> or</p>

<p class="p"> <span class="keyword apiname">CPXgetcallbacknodeinfo</span>.</p>

<p class="p">Data returned by such routines as <samp class="ph codeph">CPXgetcallbacknodeinfo</samp> or <samp class="ph codeph">CPXgetcalbackseqinfo</samp> can
be very large in some models. These numbers may not fit into 32-bit
integers, for example, if your application encounters very large iteration
counts or node counts. If you anticipate large iteration or node counts,
then you can use these <samp class="ph codeph">*_LONG</samp> symbols in
arguments to such routines as <samp class="ph codeph">CPXgetcallbackinfo</samp> or <samp class="ph codeph">CPXgetcallbackseqinfo</samp>.
If you use these symbols in anticipation of large data, then the argument <samp class="ph codeph">result_p</samp> in
these routines must point to <samp class="ph codeph">CPXLONG</samp>; this
symbol represents a 64-bit integer and is wide enough to hold the
information returned by the routines. This convention means that you
can query the information without loss of data.</p>
</li>
<li class="li"><p class="p">For the <strong class="ph b">C++ API</strong>,
use methods of the pertinent callback class; for example, the class <samp class="ph codeph">IloCplex::NodeCallbackI</samp> offers
such methods as <samp class="ph codeph">getNodeId</samp> or <samp class="ph codeph">getNodeNumber</samp> that
can now identify nodes even in a very large tree.</p>
</li>
<li class="li"><p class="p">For the <strong class="ph b">Java API</strong>,
 use methods of the pertinent callback class; for example, the method <samp class="ph codeph">IloCplex.MIPInfoCallback.getNiterations</samp> can
return a <samp class="ph codeph">long</samp> number of iterations if necessary.</p>
</li>
<li class="li"><p class="p">For the <strong class="ph b">.NET API</strong>,
 use methods of the pertinent callback class; for example, the method <samp class="ph codeph">Cplex.NodeCallback.GetNodeId</samp> can
return the index number of a node, even among a very large number
of nodes.</p>
</li>
<li class="li"><p class="p">For the <strong class="ph b">Python API</strong>,
 use methods of the pertinent callback class; for example, the method <samp class="ph codeph">get_node_ID</samp> of
the <samp class="ph codeph">cplex.callbacks.Incumbent</samp> class can
return a very large identifier now.</p>
</li>
</ul>
</div>
<div class="section" id="descriptiveTopic1301324953161__section1300644779455"><h2 class="title sectiontitle">More wherefrom values in MIP callbacks</h2><p class="p">CPLEX V12.3 offers new values for the <samp class="ph codeph">wherefrom</samp> argument
of a callback function, offering new symbols of the form <samp class="ph codeph">CPX_CALLBACK*</samp> to
specify more precisely the location from which the callback was called. </p>
<p class="p">These new symbols also specify <strong class="ph b">further
actions</strong> available to the user in MIP callbacks.
The table <a class="xref" href="releasenotescplex123_17.html#descriptiveTopic1301324953161__table1300643613814" title="A three-column table showing new values, their symbolic name, and their meaning.">Table 2</a> lists the new possible values and
their actions.</p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="A three-column table showing new values, their symbolic name, and their meaning." id="descriptiveTopic1301324953161__table1300643613814" class="table ShadedHead" rules="all" frame="border" border="1"><caption><span class="tablecap">Table 2. New wherefrom values for MIP callbacks</span></caption><thead class="thead" align="left"><tr class="row"><th class="entry" align="left" valign="top" width="33.33333333333333%" id="d265946e288">Value</th>
<th class="entry" align="left" valign="top" width="33.33333333333333%" id="d265946e290">Symbol</th>
<th class="entry" align="left" valign="top" width="33.33333333333333%" id="d265946e292">Meaning</th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e288 ">115</td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e290 "><samp class="ph codeph">CPX_CALLBACK_MIP_CUT_FEAS</samp></td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e292 ">CPLEX has found an integer feasible solution, and the user
has the option to generate a lazy constraint not satisfied by that
solution. </td>
</tr>
<tr class="row"><td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e288 ">116</td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e290 "><samp class="ph codeph">CPX_CALLBACK_MIP_CUT_UNBD</samp></td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e292 ">CPLEX has found that the LP relaxation at the current node
is primal unbounded, and the user can generate a lazy constraint to
cut off the primal ray.</td>
</tr>
<tr class="row"><td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e288 ">106</td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e290 "><samp class="ph codeph">CPX_CALLBACK_MIP_CUT_LOOP</samp></td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e292 ">The callback was called from the cut loop CPLEX executes
at each node.</td>
</tr>
<tr class="row"><td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e288 ">114</td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e290 "><samp class="ph codeph">CPX_CALLBACK_MIP_CUT_LAST</samp></td>
<td class="entry" align="left" valign="top" width="33.33333333333333%" headers="d265946e292 ">CPLEX has stopped generating cuts, but offers the user
one more chance to generate more cuts. If, as a result, cuts are added
to the  relaxation, CPLEX returns to the cut loop. See the topic <a class="xref" href="releasenotescplex123_17.html#descriptiveTopic1301324953161__section1300050326794">Exiting the loop that generates cuts from a callback</a> in these release notes for information
about <samp class="ph codeph">CPX_CALLBACK_ABORT_CUT_LOOP</samp>, an action
the user can instruct CPLEX to take (to stop the cut loop and go to
branching).</td>
</tr>
</tbody>
</table>
</div>
<p class="p">Routines or methods to access this additional information
about where the callback was invoked are available in all APIs of
CPLEX V12.3. Likewise, routines and methods to specify these additional
actions from your callback function are also available. For more information
about these actions, see the topics <a class="xref" href="releasenotescplex123_17.html#descriptiveTopic1301324953161__section1300050326794">Exiting the loop that generates cuts from a callback</a> and <a class="xref" href="releasenotescplex123_17.html#descriptiveTopic1301324953161__section1302163554290">Treating a user cut like CPLEX cuts</a> in these release notes.</p>
</div>
<div class="section" id="descriptiveTopic1301324953161__section1300050326794"><h2 class="title sectiontitle">Exiting the loop that generates cuts from a callback</h2><p class="p">A new symbol <samp class="ph codeph">CPX_CALLBACK_ABORT_CUT_LOOP</samp> (value
3) is available in CPLEX V12.3 to specify the action for CPLEX to
take when it returns from a <strong class="ph b">user cut callback</strong>.
This symbol instructs CPLEX to break out of the loop generating cuts
and move on to branching when CPLEX returns from the user cut callback. </p>
<p class="p">The action specified by this new symbol is available
in all APIs of CPLEX V12.3.</p>
<ul class="ul"><li class="li"><p class="p">For the <strong class="ph b">Callable Library
(C API)</strong>, see the documentation of <span class="keyword apiname">CPXsetusercutcallbackfun</span> in the reference manual of the Callable Library
(C API).</p>
</li>
<li class="li"><p class="p">For the <strong class="ph b">C++ API</strong>,
see the method of the class <samp class="ph codeph">IloCplex::UserCutCallbackI::abortCutLoop</samp>.</p>
</li>
<li class="li"><p class="p">For the <strong class="ph b">Java API</strong>,
see the method of the class <samp class="ph codeph">IloCplex.UserCutCallback.abortCutLoop</samp>.</p>
</li>
<li class="li"><p class="p">For the <strong class="ph b">.NET API</strong>,
see the method of the class <samp class="ph codeph">Cplex.UserCutCallback.AbortCutLoop</samp>.</p>
</li>
<li class="li"><p class="p">For the <strong class="ph b">Python API</strong>,
see the method of the class <samp class="ph codeph">cplex.callbacks.UserCutCallback.abort_cut_loop</samp>.</p>
</li>
</ul>
</div>
<div class="section" id="descriptiveTopic1301324953161__section1302163554290"><h2 class="title sectiontitle">Treating a user cut like CPLEX cuts</h2><p class="p">CPLEX V12.3 offers a way for a user to specify for CPLEX
to treat a user cut exactly as it treats CPLEX-generated cuts. That
is, you can specify for CPLEX to filter your user cut, to add your
user cut (or not) depending on its density, to add it only if the
cut is more effective than other cuts, to omit your user cut if it
is less effective than other cuts.</p>
<p class="p">To instruct CPLEX to treat your user cut just as it treats
CPLEX-generated cuts, use routines and methods available in all APIs
of CPLEX V12.3.</p>
<ul class="ul"><li class="li"><p class="p">For the <strong class="ph b">Callable Library
(C API)</strong>, use the symbol <samp class="ph codeph">CPX_USECUT_FILTER</samp> as
the value of the argument <samp class="ph codeph">purgeable</samp> in
the routine <span class="keyword apiname">CPXcutcallbackadd</span> when you add your user cut
in your application.</p>
</li>
<li class="li"><p class="p">For the <strong class="ph b">C++ API</strong>,
use the value <samp class="ph codeph">UseCutFilter</samp> in the enumeration <samp class="ph codeph">CutManagement</samp> as
the argument <samp class="ph codeph">purgeable</samp> when you add user
cuts with the method <samp class="ph codeph">UserCutCallbackI.add</samp>.</p>
</li>
<li class="li"><p class="p">For the <strong class="ph b">Java API</strong>,
use the value <samp class="ph codeph">UseCutFilter</samp> in the enumeration <samp class="ph codeph">CutManagement</samp> 
as the argument <samp class="ph codeph">purgeable</samp> when you add
user cuts with the method <samp class="ph codeph">UserCutCallback.add</samp>.</p>
</li>
<li class="li"><p class="p">For the <strong class="ph b">.NET API</strong>,
use the value <samp class="ph codeph">UseCutFilter</samp> in the enumeration <samp class="ph codeph">CutManagement</samp> when
you add user cuts with the method <samp class="ph codeph">UserCutCallback.Add</samp>.</p>
</li>
<li class="li"><p class="p">For the <strong class="ph b">Python API</strong>,
use the constant <samp class="ph codeph">cut.UserCutCallback.use_cut.filter</samp> as
the argument <samp class="ph codeph">use</samp> when you add a user cut
with the method <samp class="ph codeph">UserCutCallback.add</samp>.</p>
</li>
</ul>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../../../../CPLEX/ReleaseNotes/topics/releasenotes123/releasenotescplex123_15.html" title="Documents new features.">New features for all users</a></div>
</div>
</div></body>
</html>