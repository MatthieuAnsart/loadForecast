<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="© Copyright IBM Corporation 2015" />
<meta name="DC.Rights.Owner" content="© Copyright IBM Corporation 2015" />
<meta name="security" content="public" />
<meta name="Robots" content="index,follow" />
<meta name="DC.Type" content="topic" />
<meta name="DC.Title" content="Modeling Tips" />
<meta name="abstract" content="Tips on how to model your optimization problems for IBM ILOG CPLEX for Microsoft Excel." />
<meta name="Description" content="Tips on how to model your optimization problems for IBM ILOG CPLEX for Microsoft Excel." />
<meta name="DC.subject" content="creating an optimization model, in Microsoft Excel, modeling tips, limitaions, function probing, probing, function (Excel)" />
<meta name="keywords" content="creating an optimization model, in Microsoft Excel, modeling tips, limitaions, function probing, probing, function (Excel)" />
<meta name="DC.Relation" scheme="URI" content="../../../../CPLEX/Excel/User_manual/topics/uss_defining_an_optim_model_in_Excel_1.html" />
<meta name="DC.Date" scheme="iso8601" content="2015-05-15" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="descriptiveTopic1239352393869" />
<meta name="DC.Language" content="en-us" />
<meta name="IBM.Country" content="ZZ" />
<!-- Licensed Materials - Property of IBM -->
<!-- US Government Users Restricted Rights -->
<!-- Use, duplication or disclosure restricted by -->
<!-- GSA ADP Schedule Contract with IBM Corp. -->
<link rel="stylesheet" type="text/css" href="../../../.././ibmdita.css" />
<link rel="stylesheet" type="text/css" href="../../../.././swg_info_common_opti.css" />
<link rel="Start" href="../../../../CPLEX/Excel/User_manual/topics/uss_defining_an_optim_model_in_Excel_1.html" />
<title>Modeling Tips</title>
</head>
<body role="main" id="descriptiveTopic1239352393869">
<h1 class="title topictitle1">Modeling Tips</h1>
<div class="body"><p class="shortdesc">Tips on how to model your optimization problems for IBM
ILOG CPLEX for Microsoft Excel.</p>
<p class="p">The only explicitly supported functions are <samp class="ph codeph">SUM</samp>, <samp class="ph codeph">SUMPRODUCT</samp>,
and <samp class="ph codeph">INT</samp>. For all other functions you use
on a spreadsheet, IBM ILOG
CPLEX for Microsoft Excel probes whether these functions are linear
or quadratic.</p>
<p class="p">CPLEX for Excel recognizes an unknown function by <strong class="ph b">function
probing</strong>. In this context, function probing means
that CPLEX for Excel evaluates the unknown function at a list of carefully
chosen points to calculate coefficients of a linear or quadratic representation
of that function. If this probing yields a linear or quadratic function,
the calculated function definition is checked against a list of control
points to verify the result.</p>
<p class="p">This probing works only if the <strong class="ph b">recalculation
property</strong> of the current sheet is set to "automatic".
If the property is set to anything other than "automatic" and any
non-constant cell referenced by your model uses a function unknown
to the Excel connector, then CPLEX reports an error when you attempt
to solve the model.</p>
<p class="p">If either coefficients cannot be calculated or the validation
of calculated coefficients fails, CPLEX refuses to optimize the model.
In particular, <strong class="ph b">indirect referencing</strong> by
means of the function <samp class="ph codeph">INDIRECT()</samp> is not
supported.  </p>
<p class="p">Excel treats nonnumeric values in <samp class="ph codeph">SUM</samp> and <samp class="ph codeph">SUMPRODUCT</samp> as <samp class="ph codeph">NAN</samp> instead
of <samp class="ph codeph">0</samp>. This convention produces unexpected
results if you rely on these values being interpreted as <samp class="ph codeph">0</samp> (zero).</p>
<p class="p">In particular, <strong class="ph b">constant logical values</strong> in <samp class="ph codeph">SUM</samp> or <samp class="ph codeph">SUMPRODUCT</samp> are
treated as <samp class="ph codeph">NAN</samp> instead of <samp class="ph codeph">0</samp> and <samp class="ph codeph">1</samp>.
This convention produces unexpected results if you rely on these values
being interpreted as <samp class="ph codeph">0</samp> (zero).</p>
<p class="p">CPLEX does not prohibit complex references (unions) in
constraints but it does not handle them as expected, so they should
not be used.</p>
<p class="p">Integrality or binary constraints on constant cells are
not allowed. If you state such a constraint you will see a debug message
error and the constraint will be ignored.</p>
<p class="p">CPLEX for Excel internally converts all formulas to R1C1
style. As CPLEX has to convert formulas to strings to parse them,
and because Microsoft Excel imposes a maximum length of 256 characters
for such strings, CPLEX for Excel cannot accept formulas that contain
more than 256 characters in R1C1 style. If you receive the error message
"too long formula" then split up the formula across multiple cells.</p>
<div class="note important"><span class="importanttitle">Important:</span> <p class="p">All cells used in specifying a model (variables, constraints,
bounds, and objective) must belong to the worksheet for which the
model is defined.</p>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../../../../CPLEX/Excel/User_manual/topics/uss_defining_an_optim_model_in_Excel_1.html" title="Presents an overview of how to enter an optimization problem into Excel so that it can be solved by IBM ILOG CPLEX for Microsoft Excel.">Defining an optimization model in Excel</a></div>
</div>
</div></body>
</html>