<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="© Copyright IBM Corporation 2015" />
<meta name="DC.Rights.Owner" content="© Copyright IBM Corporation 2015" />
<meta name="security" content="public" />
<meta name="Robots" content="index,follow" />
<meta name="DC.Type" content="topic" />
<meta name="DC.Title" content="Example: Callable Library message channels" />
<meta name="abstract" content="Demonstrates control of message channels in the C API." />
<meta name="Description" content="Demonstrates control of message channels in the C API." />
<meta name="DC.subject" content="example, message handler, message handler (example), displaying, messages, output channels, channel example, CPXmsg routine, CPXopenCPLEX routine, example lpex1.c, CPXgetchannels routine, cpxerror message channel, CPXgetchannels routine, CPXaddfuncdest routine, CPXaddfpdest routine, example lpex5.c, solutions on screen, CPXdelchannel routine, CPXcloseCPLEX routine, managing input and output, CPXdelfpdest routine, CPXdelfuncdest routine" />
<meta name="keywords" content="example, message handler, message handler (example), displaying, messages, output channels, channel example, CPXmsg routine, CPXopenCPLEX routine, example lpex1.c, CPXgetchannels routine, cpxerror message channel, CPXgetchannels routine, CPXaddfuncdest routine, CPXaddfpdest routine, example lpex5.c, solutions on screen, CPXdelchannel routine, CPXcloseCPLEX routine, managing input and output, CPXdelfpdest routine, CPXdelfuncdest routine" />
<meta name="DC.Relation" scheme="URI" content="../../../../../CPLEX/UsrMan/topics/progr_consid/input_output/manageIO_msg_ch_synopsis.html" />
<meta name="DC.Date" scheme="iso8601" content="2015-05-15" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="User_manual.uss_manageIO.1002839" />
<meta name="DC.Language" content="en-us" />
<meta name="IBM.Country" content="ZZ" />
<!-- Licensed Materials - Property of IBM -->
<!-- US Government Users Restricted Rights -->
<!-- Use, duplication or disclosure restricted by -->
<!-- GSA ADP Schedule Contract with IBM Corp. -->
<link rel="stylesheet" type="text/css" href="../../../../.././ibmdita.css" />
<link rel="stylesheet" type="text/css" href="../../../../.././swg_info_common_opti.css" />
<link rel="Start" href="../../../../../CPLEX/UsrMan/topics/progr_consid/input_output/manageIO_msg_ch_synopsis.html" />
<title>Example: Callable Library message channels</title>
</head>
<body role="main" id="User_manual.uss_manageIO.1002839">
<h1 class="title topictitle1">Example: Callable Library message channels</h1>
<div class="body"><p class="shortdesc">Demonstrates control of message channels in the C API.</p>
<p class="p">This example shows you how to use the CPLEX message handler from
the Callable Library. It captures all messages generated by CPLEX
and displays them on screen along with a label indicating which channel
sent the message. It also creates a user channel to receive output
generated by the program itself. The user channel accepts user-generated
messages, displays them on screen with a label, and records them in
a file without the label.</p>
<p class="p">The complete program <samp class="ph codeph">lpex5.c</samp> appears online in
the standard distribution at <em class="ph i">yourCPLEXinstallation</em> <samp class="ph codeph">/examples/src</samp>.
This example derives from <samp class="ph codeph">lpex1.c</samp>, a program in <em class="ph i">Getting
Started</em>. There are a few differences between the two examples:</p>
<ul class="ul"><li class="li"><p class="p">In this example, the function <samp class="ph codeph">ourmsgfunc</samp> (rather
than the C functions <samp class="ph codeph">printf</samp> or <samp class="ph codeph">fprintf(stderr, . . .)</samp>)
manages all output. The program itself or <samp class="ph codeph"><a class="xref" href="../../../../../refcallablelibrary/cpxapi/msg.html" title="The routine CPXXmsg/CPXmsg writes a message to a specified channel.">CPXmsg</a></samp> from
the CPLEX Callable Library calls <samp class="ph codeph">ourmsgfunc</samp>. In fact, <samp class="ph codeph">CPXmsg</samp> is
a replacement for <samp class="ph codeph">printf</samp>, allowing a message to appear
in more than one place, for example, both on screen and in a file.</p>
<p class="p">Only
after you initialize the CPLEX environment by calling <samp class="ph codeph"><a class="xref" href="../../../../../refcallablelibrary/cpxapi/openCPLEX.html" title="The routine CPXXopenCPLEX/CPXopenCPLEX initializes a CPLEX environment.">CPXopenCPLEX</a></samp> can
you call <samp class="ph codeph">CPXmsg</samp>. And only after you call <samp class="ph codeph"><a class="xref" href="../../../../../refcallablelibrary/cpxapi/getchannels.html" title="The routine CPXXgetchannels/CPXgetchannels obtains pointers to the four default channels created when you call the routine CPXXopenCPLEX/CPXopenCPLEX.">CPXgetchannels</a></samp> can
you use the default CPLEX channels. Therefore, calls to <samp class="ph codeph">ourmsgfunc</samp> print
directly any messages that occur before the program gets the address
of <samp class="ph codeph">cpxerror</samp> (a channel). After a call to <samp class="ph codeph">CPXgetchannels</samp> gets
the address of <samp class="ph codeph">cpxerror</samp>, and after a call to <samp class="ph codeph"><a class="xref" href="../../../../../refcallablelibrary/cpxapi/addfuncdest.html" title="The routine CPXXaddfuncdest/CPXaddfuncdest adds a function msgfunction to the message destination list for a channel.">CPXaddfuncdest</a></samp> associates
the message function <samp class="ph codeph">ourmsgfunc</samp> with <samp class="ph codeph">cpxerror</samp>,
then error messages are generated by calls to <samp class="ph codeph">CPXmsg</samp>.</p>
 <p class="p">After
the <samp class="ph codeph">TERMINATE:</samp> label, any error must be generated
with care in case the error message function has not been set up properly.
Thus, <samp class="ph codeph">ourmsgfunc</samp> is also called directly to generate
any error messages there.</p>
 </li>
<li class="li"><p class="p">The Callable Library routine 
<samp class="ph codeph"><a class="xref" href="../../../../../refcallablelibrary/cpxapi/fopen.html" title="The routine CPXXfopen/CPXfopen opens files to be used in conjunction with the routines CPXaddfpdest, CPXXdelfpdest/CPXdelfpdest and CPXXsetlogfile/CPXsetlogfile.">CPXfopen</a></samp> 
opens the file <samp class="ph codeph">lpex5.msg</samp> to accept solution information.
A call to the Callable Library routine <samp class="ph codeph"><a class="xref" href="../../../../../refcallablelibrary/cpxapi/addfpdest.html" title="The routine CPXXaddfpdest/CPXaddfpdest adds a file to the list of message destinations for a channel.">CPXaddfpdest</a></samp> associates
that file with that channel. Solution information is also displayed
on screen since <samp class="ph codeph">ourmsgfunc</samp>  is associated with that
new channel, too. Thus in the loops near the end of <samp class="ph codeph">main</samp> ,
when the solution is printed, only one call to <samp class="ph codeph">CPXmsg</samp> 
suffices to put the output both on screen and into the file.</p>
 </li>
<li class="li"><p class="p">Although <samp class="ph codeph"><a class="xref" href="../../../../../refcallablelibrary/cpxapi/closeCPLEX.html" title="This routine frees all of the data structures associated with CPLEX.">CPXcloseCPLEX</a></samp> will
automatically delete file- and function-destinations for channels,
it is a good practice to call <samp class="ph codeph"><a class="xref" href="../../../../../refcallablelibrary/cpxapi/delfpdest.html" title="The routine CPXXdelfpdest/CPXdelfpdest removes a file from the list of message destinations for a channel.">CPXdelfpdest</a></samp> and <samp class="ph codeph"><a class="xref" href="../../../../../refcallablelibrary/cpxapi/delfuncdest.html" title="The routine CPXXdelfuncdest/CPXdelfuncdest removes the function msgfunction from the list of message destinations associated with a channel.">CPXdelfuncdest</a></samp> at
the end of your programs.</p>
</li>
</ul>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../../../../../CPLEX/UsrMan/topics/progr_consid/input_output/manageIO_msg_ch_synopsis.html" title="Describes message channels.">Controlling message channels</a></div>
</div>
</div></body>
</html>